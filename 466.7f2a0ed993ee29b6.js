"use strict";(self.webpackChunkAlibaba_Pro=self.webpackChunkAlibaba_Pro||[]).push([[466],{4466:(E,f,c)=>{c.d(f,{m:()=>G});var g=c(6895),i=c(3599),C=c(1077),l=c(7918),p=c(3172),u=c(7359),y=c(529),w=c(1571);let G=(()=>{const m=class{};let v=m;return m.\u0275fac=function(d){return new(d||m)},m.\u0275mod=w.oAB({type:m}),m.\u0275inj=w.cJS({imports:[g.ez,i.Bz,p.sF,l.P,C.Ye,u.Rh.forRoot(),y.JF,p.sF,l.P,C.Ye,u.Rh,y.JF]}),v})()},7918:(E,f,c)=>{c.d(f,{P:()=>C,x:()=>i});var g=c(1571);let i=(()=>{class l{constructor(u){this.el=u,this.from=0,this.duration=4,this.e=this.el.nativeElement,this.refreshInterval=30,this.step=0}ngOnInit(){}ngOnChanges(){this.CountTo&&this.start()}calculate(){this.duration=1e3*this.duration,this.steps=Math.ceil(this.duration/this.refreshInterval),this.increment=(this.CountTo-this.from)/this.steps,this.num=this.from}tick(){setTimeout(()=>{this.num+=this.increment,this.step++,this.step>=this.steps?(this.num=this.CountTo,this.e.textContent=this.CountTo):(this.e.textContent=Math.round(this.num),this.tick())},this.refreshInterval)}start(){this.calculate(),this.tick()}}return l.\u0275fac=function(u){return new(u||l)(g.Y36(g.SBq))},l.\u0275dir=g.lG2({type:l,selectors:[["","CountTo",""]],inputs:{from:"from",duration:"duration",CountTo:"CountTo"},features:[g.TTD]}),l})(),C=(()=>{class l{static forRoot(){return{ngModule:l,providers:[]}}static forChild(){return{ngModule:l,providers:[]}}}return l.\u0275fac=function(u){return new(u||l)},l.\u0275mod=g.oAB({type:l}),l.\u0275inj=g.cJS({}),l})()},1077:(E,f,c)=>{c.d(f,{P4:()=>y,Ye:()=>v});var g=c(7582),i=c(1571);let C=(()=>{class a{constructor(e){this.opt=e,this.dataTableChanged=new i.vpe,e&&this._setDataTable(e.dataTable,e.firstRowIsData)}send(){void 0!==this.query&&this.query.send(e=>{this.setDataTable(e.getDataTable()),this.opt.queryCallback&&this.opt.queryCallback(e)})}init(e){e&&(this.opt=e),void 0!==this.tid&&(window.clearInterval(this.tid),this.tid=void 0),this.opt.dataSourceUrl?(this.query=new google.visualization.Query(this.opt.dataSourceUrl),this.opt.query&&this.query.setQuery(this.opt.query),void 0!==this.opt.timeout&&this.query.setTimeout(this.opt.timeout),this.opt.refreshInterval&&(this.tid=window.setInterval(()=>{this.send()},1e3*this.opt.refreshInterval)),this.send()):this.setDataTable(this.opt.dataTable)}getDataTable(){return this.dataTable}setDataTable(e,t){void 0===t&&(t=this.opt.firstRowIsData),this._setDataTable(e,t),this.dataTableChanged.emit(this.dataTable)}_setDataTable(e,t){Array.isArray(e)&&(e=google.visualization.arrayToDataTable(e,t)),this.dataTable=e,this.reformat()}reformat(){const e=this.dataTable;if(void 0!==e&&void 0!==this.opt.formatters)for(const t of this.opt.formatters){let o;if("PatternFormat"===t.type){const n=t.options;o=new google.visualization.PatternFormat(n.pattern),o.format(e,t.columns,n.dstColumnIndex);continue}const r=google.visualization[t.type],s=t.options;if(o=new r(s),"ColorFormat"===t.type&&s){const n=s;if(n.ranges)for(const h of n.ranges)typeof h.fromBgColor<"u"&&typeof h.toBgColor<"u"?o.addGradientRange(h.from,h.to,h.color,h.fromBgColor,h.toBgColor):o.addRange(h.from,h.to,h.color,h.bgcolor)}for(const n of t.columns)o.format(e,n)}}}return a.\u0275fac=function(e){i.$Z()},a.\u0275dir=i.lG2({type:a,outputs:{dataTableChanged:"dataTableChanged"}}),a})(),l=(()=>{class a{constructor(e){this.el=e}setPosition(e,t){this.el.nativeElement.style.left=e+a.PIXELS,this.el.nativeElement.style.top=t+a.PIXELS}getDOMElement(){return this.el}}return a.PIXELS="px",a})(),p=(()=>{class a{constructor(e,t){this.googleChartsSettings=t,this.loadedPackages=[],this.loaded=!1,this.googleChartsSettings=Object.assign(Object.assign({},{googleChartsVersion:"50",language:e}),this.googleChartsSettings),this.googleScriptLoadingNotifier=new i.vpe,this.googleChartLoadingNotifier=new i.vpe,this.googleScriptIsLoading=!1,this.googleChartIsLoading=!1,this.loadGoogleChartsScriptPromise=new Promise((r,s)=>{if(typeof google<"u"&&google.charts)r();else if(this.googleScriptIsLoading)this.googleScriptLoadingNotifier.subscribe(n=>{n?r():s()});else{this.googleScriptIsLoading=!0;const n=document.createElement("script");n.type="text/javascript",n.src="https://www.gstatic.com/charts/loader.js",n.async=!0,n.defer=!0,n.onload=()=>{this.googleScriptIsLoading=!1,this.googleScriptLoadingNotifier.emit(!0),r()},n.onerror=()=>{this.googleScriptIsLoading=!1,this.googleScriptLoadingNotifier.emit(!1),s()},document.getElementsByTagName("head")[0].appendChild(n)}})}load(e){return(0,g.mG)(this,void 0,void 0,function*(){yield this.loadGoogleChartsScriptPromise,yield new Promise(t=>{this.googleChartIsLoading?this.googleChartLoadingNotifier.subscribe(()=>{this.doLoad(t,e)}):this.doLoad(t,e)})})}doLoad(e,t){if(!(t=Object.assign(Object.assign({},this.googleChartsSettings),t)).packages&&this.loaded)return void e();if(t.packages){let r=t.packages.filter(s=>this.loadedPackages.indexOf(s)<0);if(0==r.length&&this.loaded)return void e();t.packages=r}const o=t;o.callback=()=>{this.googleChartIsLoading=!1,void 0!==o.packages&&(this.loadedPackages=this.loadedPackages.concat(o.packages)),this.loaded=!0,this.googleChartLoadingNotifier.emit(),e()},this.googleChartIsLoading=!0,google.charts.load(t.googleChartsVersion,o)}}return a.\u0275fac=function(e){return new(e||a)(i.LFG(i.soG),i.LFG("googleChartsSettings",8))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),y=(()=>{class a{constructor(e,t){this.el=e,this.loaderService=t,this.selectListener=()=>{const o={message:"select",row:null,column:null,selectedRowValues:[],selectedRowFormattedValues:[],columnLabel:""},r=this.wrapper.visualization.getSelection(),s=r[r.length-1];if(!s)return o.message="deselect",o;const n=s;if(null!=s.row){o.row=n.row;const h=[],T=[],O=this.wrapper.getDataTable(),D=O.getNumberOfColumns();for(let b=0;b<D;b++)h.push(O.getValue(n.row,b)),T.push(O.getFormattedValue(n.row,b));o.selectedRowValues=h,o.selectedRowFormattedValues=T}return null!=n.column&&(o.column=n.column,o.columnLabel=this.getColumnLabelAtPosition(n)),s.name&&(o.columnLabel=s.name),o},this.chartSelect=new i.vpe,this.chartSelectOneTime=new i.vpe,this.chartReady=new i.vpe,this.chartReadyOneTime=new i.vpe,this.chartError=new i.vpe,this.chartErrorOneTime=new i.vpe,this.mouseOver=new i.vpe,this.mouseOverOneTime=new i.vpe,this.mouseOut=new i.vpe,this.mouseOutOneTime=new i.vpe,this.regionClick=new i.vpe,this.regionClickOneTime=new i.vpe}ngOnInit(){this.HTMLel=this.el.nativeElement.querySelector("div"),Object.isExtensible(this.data)&&(this.data.component=this),this.options=this.data.options,this.init().then(()=>{this.draw()})}init(){return(0,g.mG)(this,void 0,void 0,function*(){yield this.loaderService.load(),this.recreateWrapper()})}recreateWrapper(){if(void 0===this.wrapper||this.wrapper.getChartType()!==this.data.chartType){this.dataTable=new C(this.data),this.dataTable.dataTableChanged.subscribe(t=>{this._draw()});let e=this.data;if(this.data.firstRowIsData&&(e=Object.assign(e,this.data),e.dataTable=this.dataTable.getDataTable()),this.wrapper=new google.visualization.ChartWrapper(e),this.registerChartWrapperEvents(),void 0===e.dataTable&&void 0===e.dataSourceUrl)try{this.wrapper.draw(this.HTMLel)}catch{}}}_draw(){return(0,g.mG)(this,void 0,void 0,function*(){const e=this.dataTable.getDataTable();void 0!==e&&(this.convertOptions(),this.recreateWrapper(),this.wrapper.setOptions(this.options),this.wrapper.setDataTable(e),this.wrapper.draw(this.HTMLel))})}getDataTable(){return this.dataTable}draw(e){void 0===e&&(e=this.data),this.options=e.options,this.dataTable.init(e)}getSelectorBySeriesType(e){return{bars:"bar#%s#%r",haxis:"hAxis#0#label",line:"point#%s#%r",legend:"legendentry#%s",area:"point#%s#%r"}[e]}getSeriesByColumn(e){let t=0;const o=this.wrapper.getDataTable();for(let r=e-1;r>=0;r--){const s=o.getColumnRole(r),n=o.getColumnType(r);("data"===s||"number"===n)&&t++}return t}getBoundingBoxForItem(e){let t={top:0,left:0,width:0,height:0};if(this.cli){const o=e.column,r=this.getSeriesByColumn(o),s=e.row;let n=this.options.seriesType;if(this.options.series&&this.options.series[r]&&this.options.series[r].type&&(n=this.options.series[r].type),n){let h=this.getSelectorBySeriesType(n);if(h){h=h.replace("%s",r+"").replace("%c",o+"").replace("%r",s+"");const T=this.cli.getBoundingBox(h);T&&(t=T)}}}return t}getValueAtPosition(e){return null==e.row?null:this.wrapper.getDataTable().getValue(e.row,e.column)}getColumnTypeAtPosition(e){return this.wrapper.getDataTable().getColumnType(e.column)||""}getColumnLabelAtPosition(e){return this.wrapper.getDataTable().getColumnLabel(e.column)||""}getHTMLTooltip(){const e=new i.SBq(this.el.nativeElement.querySelector(".google-visualization-tooltip"));return new l(e)}parseMouseEvent(e){const t=this.wrapper.getChartType();let o=e.column;null==o&&(o="Timeline"===t?3===this.wrapper.getDataTable().getNumberOfColumns()?0:1:0);const s={row:e.row,column:o};return{position:e,boundingBox:this.getBoundingBoxForItem(s),value:this.getValueAtPosition(s),columnType:this.getColumnTypeAtPosition(s),columnLabel:this.getColumnLabelAtPosition(s)}}registerChartEvents(){const e=this.wrapper.getChart();this.cli=e.getChartLayoutInterface?e.getChartLayoutInterface():null,this.mouseOver.observers.length>0&&google.visualization.events.addListener(e,"onmouseover",t=>{const o=this.parseMouseEvent(t);o.tooltip=this.getHTMLTooltip(),this.mouseOver.emit(o)}),this.mouseOverOneTime.observers.length>0&&google.visualization.events.addOneTimeListener(e,"onmouseover",t=>{const o=this.parseMouseEvent(t);o.tooltip=this.getHTMLTooltip(),this.mouseOverOneTime.emit(o)}),this.mouseOut.observers.length>0&&google.visualization.events.addListener(e,"onmouseout",t=>{const o=this.parseMouseEvent(t);this.mouseOut.emit(o)}),this.mouseOutOneTime.observers.length>0&&google.visualization.events.addOneTimeListener(e,"onmouseout",t=>{const o=this.parseMouseEvent(t);this.mouseOutOneTime.emit(o)}),"GeoChart"===this.data.chartType&&(this.regionClick.observers.length>0&&google.visualization.events.addListener(e,"regionClick",t=>{this.regionClick.emit(t)}),this.regionClickOneTime.observers.length>0&&google.visualization.events.addOneTimeListener(e,"regionClick",t=>{this.regionClick.emit(t)}))}registerChartWrapperEvents(){google.visualization.events.addListener(this.wrapper,"ready",()=>{this.chartReady.emit({message:"Chart ready"})}),google.visualization.events.addOneTimeListener(this.wrapper,"ready",()=>{this.chartReadyOneTime.emit({message:"Chart ready (one time)"}),this.registerChartEvents()}),google.visualization.events.addListener(this.wrapper,"error",e=>{this.chartError.emit(e)}),google.visualization.events.addOneTimeListener(this.wrapper,"error",e=>{this.chartErrorOneTime.emit(e)}),this.addListener(this.wrapper,"select",this.selectListener,this.chartSelect),this.addOneTimeListener(this.wrapper,"select",this.selectListener,this.chartSelectOneTime)}addListener(e,t,o,r){google.visualization.events.addListener(e,t,()=>{r.emit(o())})}addOneTimeListener(e,t,o,r){google.visualization.events.addOneTimeListener(e,t,()=>{r.emit(o())})}convertOptions(){try{this.options=google.charts[this.data.chartType].convertOptions(this.options)}catch{return}}}return a.\u0275fac=function(e){return new(e||a)(i.Y36(i.SBq),i.Y36(p))},a.\u0275cmp=i.Xpm({type:a,selectors:[["google-chart"]],inputs:{data:"data"},outputs:{chartReady:"chartReady",chartReadyOneTime:"chartReadyOneTime",chartError:"chartError",chartErrorOneTime:"chartErrorOneTime",chartSelect:"chartSelect",chartSelectOneTime:"chartSelectOneTime",mouseOver:"mouseOver",mouseOverOneTime:"mouseOverOneTime",mouseOut:"mouseOut",mouseOutOneTime:"mouseOutOneTime",regionClick:"regionClick",regionClickOneTime:"regionClickOneTime"},decls:1,vars:0,template:function(e,t){1&e&&i._UZ(0,"div")},encapsulation:2}),a})(),v=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=i.oAB({type:a}),a.\u0275inj=i.cJS({providers:[p]}),a})()}}]);